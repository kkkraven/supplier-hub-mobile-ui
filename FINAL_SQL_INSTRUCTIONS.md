# üöÄ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –í–´–ü–û–õ–ù–ï–ù–ò–Æ SQL-–°–ö–†–ò–ü–¢–ê

## ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

–§–∞–π–ª `.env.local` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:
- ‚úÖ `NEXT_PUBLIC_SUPABASE_URL`
- ‚úÖ `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- ‚ö†Ô∏è `SUPABASE_SERVICE_ROLE_KEY` - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å

## üîë –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ Service Role Key

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å Supabase:**
   - https://supabase.com/dashboard
   - –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
   - –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: `lhdjfkxrislqiivafsew`

2. **–ü–æ–ª—É—á–∏—Ç–µ Service Role Key:**
   - –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ "Settings"
   - –í—ã–±–µ—Ä–∏—Ç–µ "API"
   - –ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é "Project API keys"
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ "service_role" key (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `eyJ...`)

3. **–û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª .env.local:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `web/.env.local`
   - –ó–∞–º–µ–Ω–∏—Ç–µ `your_service_role_key_here` –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –∫–ª—é—á

## üóÑÔ∏è –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-—Å–∫—Ä–∏–ø—Ç

### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor –≤ Supabase:**
   - –í –ø–∞–Ω–µ–ª–∏ Supabase –Ω–∞–π–¥–∏—Ç–µ "SQL Editor"
   - –ù–∞–∂–º–∏—Ç–µ "New query"

2. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ –ø–æ—Ä—è–¥–∫—É:**

```sql
-- 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è website
ALTER TABLE factories 
ADD COLUMN IF NOT EXISTS website TEXT;

-- 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
COMMENT ON COLUMN factories.website IS '–í–µ–±-—Å–∞–π—Ç —Ñ–∞–±—Ä–∏–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)';

-- 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
UPDATE factories 
SET website = CASE 
    WHEN legal_name_en ILIKE '%Golden Thread%' THEN 'https://www.goldenthread.com'
    WHEN legal_name_en ILIKE '%Sunrise%' THEN 'https://www.sunrisetextile.com'
    WHEN legal_name_en ILIKE '%Imperial%' THEN 'https://www.imperialweaving.com'
    WHEN legal_name_en ILIKE '%Oriental%' THEN 'https://www.orientalsilk.com'
    WHEN legal_name_en ILIKE '%South China%' THEN 'https://www.southchina.com'
    ELSE NULL
END
WHERE website IS NULL;

-- 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
SELECT 
    legal_name_en,
    wechat_id,
    phone,
    email,
    website,
    address_cn
FROM factories 
LIMIT 5;
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ Node.js —Å–∫—Ä–∏–ø—Ç

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è service_role_key –≤ .env.local:

```bash
cd "c:\prog\Supplier Hub Mobile-First UI Kit\web"
node execute_sql.js
```

## üîç –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

1. **–í –ø–∞–Ω–µ–ª–∏ Supabase:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ "Table Editor"
   - –ù–∞–π–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É "factories"
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—è–≤–∏–ª–æ—Å—å –ø–æ–ª–µ "website"

2. **–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `npm run dev`
   - –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:3000
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ñ–∞–±—Ä–∏–∫ - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –≤–µ–±-—Å–∞–π—Ç—ã

## üìã –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- –ü–æ–ª–µ `website` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—É `factories`
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω –∫ –ø–æ–ª—é
- –ü—Ä–∏–º–µ—Ä—ã –≤–µ–±-—Å–∞–π—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–±—Ä–∏–∫

‚úÖ **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
- WeChat ID –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Ñ–∞–±—Ä–∏–∫
- –¢–µ–ª–µ—Ñ–æ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
- Email –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è —Ñ–∞–±—Ä–∏–∫, –≥–¥–µ –µ—Å—Ç—å
- Website –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –¥–ª—è —Ñ–∞–±—Ä–∏–∫ —Å —Å–∞–π—Ç–∞–º–∏
- –ê–¥—Ä–µ—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é

## üÜò –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied"
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ service_role_key, –∞ –Ω–µ anon_key

### –ü—Ä–æ–±–ª–µ–º–∞: "Table does not exist"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ "factories" —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –≤–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: "Column already exists"
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –∑–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç "IF NOT EXISTS"

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase

---
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é! üéâ
